<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Edvengers Teacher Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body class="portal-body">
    <header class="ev-header">
      <div class="ev-container ev-nav">
        <div class="ev-logo">
          <span class="ev-logo-mark">E</span>
          <span class="ev-logo-text">Edvengers</span>
        </div>
        <nav class="ev-nav-links">
          <a href="index.html" class="btn btn-ghost btn-back">‚Üê Back to Main Site</a>
        </nav>
      </div>
    </header>

    <main>
      <section id="teacher-login-section">
        <div class="ev-container" style="padding:2.5rem 0 3rem;">
          <h1>Teacher Login</h1>
          <div class="dashboard-card">
            <form id="teacher-login-form">
              <div class="form-field">
                <label>Username</label>
                <input id="teacher-username" type="text" placeholder="e.g. andy" required />
              </div>
              <div class="form-field">
                <label>Password</label>
                <input id="teacher-password" type="password" required />
              </div>
              <button type="submit" class="btn btn-primary">Enter Dashboard</button>
            </form>
          </div>
        </div>
      </section>

      <section id="teacher-dashboard-section" style="display:none;">
        <div class="ev-container" style="padding:2.5rem 0 3.5rem;">
          
          <div class="dashboard-top-row">
            <h1>Teacher Dashboard</h1>
            <button id="teacher-logout-btn" class="btn btn-ghost">Log out</button>
          </div>

          <div class="ev-tab-nav">
            <button class="ev-tab-btn active" onclick="switchTab('admin')">üèõÔ∏è Admin HQ</button>
            <button class="ev-tab-btn" onclick="switchTab('missions')">üöÄ Missions Control</button>
            <button class="ev-tab-btn" onclick="switchTab('comms')">üí¨ Comms Link</button>
          </div>

          <div id="tab-admin" class="ev-tab-content active">
            <section class="dashboard-card">
              <div class="card">
                <h2>Students &amp; Hero Points</h2>
                <form id="students-form">
                  <div class="form-row">
                    <div class="form-group">
                      <label>Filter Level</label>
                      <select id="filter-level" class="input"><option value="">All</option><option value="P3">P3</option><option value="P4">P4</option><option value="P5">P5</option><option value="P6">P6</option></select>
                    </div>
                    <div class="form-group">
                      <label>Select Student</label>
                      <select id="student-select" class="input"><option value="">-- Select --</option></select>
                    </div>
                  </div>
                  <div id="students-list" class="students-list"></div>
                  <button type="button" id="update-points-btn" class="btn" style="margin-top:0.5rem;">Update Points</button>
                  
                  <details class="ev-collapsible" style="margin-top: 1rem;">
                    <summary>Add/Edit Student</summary>
                    <div class="form-row" style="margin-top:1rem;">
                      <div class="form-group"><label>Name</label><input id="student-name" type="text" class="input" /></div>
                      <div class="form-group"><label>Level</label><select id="student-level" class="input"><option value="P5">P5</option><option value="P6">P6</option></select></div>
                      <div class="form-group"><label>Subjects</label><select id="student-subjects" class="input" multiple><option value="P5 English">P5 English</option><option value="P5 Math">P5 Math</option><option value="P6 English">P6 English</option><option value="P6 Math">P6 Math</option></select></div>
                    </div>
                    <button type="submit" class="btn">Save Student</button>
                  </details>
                </form>
              </div>
            </section>
            <section class="dashboard-card">
              <div class="card-header">Announcements</div>
              <form id="announcement-form">
                <input id="announcement-title" type="text" placeholder="Title" required />
                <textarea id="announcement-message" rows="2" placeholder="Message" required></textarea>
                <div style="margin:0.5rem 0;"><label><input type="checkbox" id="announcement-pinned" /> Pin to top üìå</label></div>
                <div class="form-field">
                  <select id="announcement-level" class="input"><option value="">All Levels</option><option value="P5">P5</option><option value="P6">P6</option></select>
                </div>
                <button type="submit" class="btn btn-primary">Post</button>
              </form>
              <div id="announcement-list" style="margin-top:1rem;"></div>
            </section>
          </div>

          <div id="tab-missions" class="ev-tab-content">
            
            <section class="dashboard-card">
              <div class="card-header">üèãÔ∏è The Writing Gym</div>
              
              <details class="ev-collapsible">
                <summary style="background:var(--ev-bg-alt); padding:0.75rem; border-radius:8px; cursor:pointer; border:1px solid var(--ev-border-soft);">
                  <strong>‚ûï Create New Drill</strong>
                </summary>
                <form id="gym-create-form" style="padding:1rem; border:1px solid var(--ev-border-soft); margin-top:0.5rem;">
                  <div class="dashboard-grid">
                    <div class="form-field"><label>Title</label><input id="drill-title" type="text" required /></div>
                    <div class="form-field"><label>Level</label><select id="drill-level" class="input"><option value="P5">P5</option><option value="P6">P6</option></select></div>
                  </div>
                  <div class="form-field"><label>Image</label><input type="file" id="drill-image" accept="image/*" /></div>
                  <div class="form-field"><label>Instructions</label><textarea id="drill-instructions" rows="2" required></textarea></div>
                  <div class="form-field"><label>Power Words</label><input id="drill-powerwords" type="text" placeholder="Agony, Chaos..." /></div>
                  <div class="form-field"><label>ü§ñ Hidden AI Prompt</label><textarea id="drill-ai-prompt" rows="2" placeholder="Act as a PSLE marker..." required></textarea></div>
                  <button type="submit" class="btn btn-primary" style="width:100%;">Deploy Mission</button>
                  <p id="drill-status" class="helper-text"></p>
                </form>
              </details>

              <div style="margin-top:2rem;">
                <h4>Submission Inbox</h4>
                <div id="gym-inbox-container" style="display:flex; flex-direction:column; gap:0.8rem;">
                   <p class="helper-text">Waiting for intel...</p>
                </div>
              </div>

              <div style="margin-top:2rem;">
                 <h4>Active Missions</h4>
                 <div id="drill-list-container"></div>
              </div>
            </section>

            <section class="dashboard-card">
              <div class="card-header">Homework &amp; Training</div>
              <form id="homework-form">
                <input id="homework-title" type="text" placeholder="Title" required />
                <textarea id="homework-description" rows="2"></textarea>
                <input id="homework-link-1" type="url" placeholder="Main Link URL" required />
                <select id="homework-level" class="input"><option value="">All Levels</option><option value="P5">P5</option><option value="P6">P6</option></select>
                <button type="submit" class="btn btn-primary">Add Homework</button>
              </form>
              <div id="homework-list" style="margin-top:1rem;"></div>
              
              <hr style="border-color:var(--ev-border-soft); margin:1.5rem 0;">
              
              <h4>Blooket Links (Self Training)</h4>
              <form id="training-links-form">
                <div class="dashboard-grid">
                  <div class="form-field"><label>P5 Eng</label><input id="link-p5-english" type="url" /></div>
                  <div class="form-field"><label>P5 Math</label><input id="link-p5-math" type="url" /></div>
                </div>
                <button type="submit" class="btn">Save Links</button>
              </form>
            </section>
          </div>

          <div id="tab-comms" class="ev-tab-content">
            <section class="dashboard-card" style="height: 80vh;">
              <div class="chat-layout" style="height: 100%;">
                <aside class="chat-sidebar" id="chat-student-list"></aside>
                <section class="chat-main">
                  <div id="chat-thread" class="chat-window" style="height:100%;"></div>
                  <form id="teacher-chat-form" class="chat-form">
                    <input type="hidden" id="teacher-chat-student-id" />
                    <textarea id="teacher-chat-input" rows="1" placeholder="Reply..."></textarea>
                    <button type="submit" class="btn btn-primary">Send</button>
                  </form>
                </section>
              </div>
            </section>
          </div>

        </div>
      </section>
    </main>

    <footer class="ev-footer">
      <div class="ev-container"><p>¬© <span id="year"></span> Edvengers.</p></div>
    </footer>
    <script>document.getElementById("year").textContent = new Date().getFullYear();</script>
    <script src="app-teacher.js" type="module"></script>
  </body>
</html>